<% @diagnostics.each do |diagnostic| %>
  <div class="row span12 well section chart" data-animation="true" data-content="<%= percent_completed(@completed[diagnostic.id], @sums[diagnostic.id]) %>%" data-html="true" data-title="Percent Complete" data-trigger="hover">
    <%= link_to diagnostic.name, diagnostic_path(diagnostic) %>
    <span class="admin pull-right">
      <% if check_admin(current_user) %>
        <%= link_to 'Edit Content', diagnostic_admin_path(diagnostic), id: 'show-content', data: { diagnostic_id: diagnostic.id } %>
        |
        <%= link_to 'Edit Name and Description', edit_diagnostic_path(diagnostic) %>
        |
        <%= link_to 'Delete', diagnostic, method: :delete, data: { confirm: 'Are you sure? This will delete all the content of this diagnostic.' } %>
      <% else %>
        <%= link_to 'Show Content', diagnostic_admin_path(diagnostic), id: 'show-content', data: { diagnostic_id: diagnostic.id } %>
      <% end %>
    </span>
    <div class="row head2">
      <%= diagnostic.description %>
    </div>
    <div id="chart<%= diagnostic.id %>"></div>
    <script>
      var d = [
                <% diagnostic.segments.each do |segment| %>
                  {axis: "<%= segment.name %>", value: "<%= percent_completed(segment.yes(current_user), segment.total(current_user)) %>"}, 
                <% end %>
              ];


      RadarChart.draw("#chart<%= diagnostic.id %>", [d]);

    </script>
  </div>
<% end %>